$(document).ready(function(){function e(){d.on("click",function(){$(this).toggleClass("open")}),c.on("keyup",t),o.on("click",function(){var e=$(this).data("id");$(this).hasClass("selected")?($(this).removeClass("selected"),r.each(function(){$(this).data("id")===e&&($(this).addClass("hidden"),n.find('option[value="'+e+'"]').attr("selected",!1))})):($(this).addClass("selected"),r.each(function(){$(this).data("id")===e&&($(this).removeClass("hidden"),n.find("option[value="+e+"]").attr("selected",!0))})),n.trigger("change")}),l.on("click",function(){var e=$(this).closest(r),t=e.data("id");e.addClass("hidden"),n.find('option[value="'+t+'"]').attr("selected",!1),$('.js-dropdown-item[data-id="'+t+'"]').removeClass("selected")}),u.on("submit",function(e){var t=s();this.checkValidity()&&(e.preventDefault(),$.ajax({type:"POST",url:"/admin_v2/core/formhandler/add/client.php",data:t,dataType:"json",success:function(e){if(u.find("input").closest(".form-group").removeClass("has-error"),"error"===e.status)switch(e.message){case"email_exists":u.find("input[name=email]").closest(".form-group").addClass("has-error")}else if("success"===e.status){var s=new Option(t.first_name+"  "+t.last_name,e.client_id,!0,!0);p.append(s).trigger("change")}}}))}),$(".js-preview-btn").on("click",function(e){h[0].checkValidity()&&(e.preventDefault(),$(".js-main-block").addClass("preview-on"),a())})}function t(){var e=$(this).val();o.each(function(){$(this).text().search(new RegExp(e,"i"))<0?$(this).fadeOut():$(this).show()})}function s(){var e={};return u.find("input").each(function(){e[$(this).attr("name")]=$(this).val()}),e}function i(){var e={};return f.each(function(){switch($(this)[0].tagName){case"INPUT":case"SELECT":e[$(this).attr("id")]=$(this).val()}}),e}function a(){var e=i();$.ajax({type:"POST",url:"/admin_v2/core/formhandler/add/order.php?preview=true",data:e,dataType:"json",success:function(e){console.log(e),$(".js-preview-block").html(e.html)}})}var n=$(".js-select"),d=(n.find("option"),$(".js-pseudo-select")),c=$(".js-input"),o=$(".js-dropdown-item"),r=($(".js-added-block"),$(".js-added-item")),l=$(".js-remove-added"),u=$(".js-client-form"),h=($(".js-clien-submit"),$(".order-form")),f=h.find("input:not(.hidden-input), select"),p=$(".js-client-select");!function(){e()}()});